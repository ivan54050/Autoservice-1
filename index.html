<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Мобільна база посилок</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f9f9f9;
    }
    h1 {
      text-align: center;
      font-size: 1.4rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      box-sizing: border-box;
      font-size: 1rem;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      margin-top: 1.5rem;
      border-radius: 5px;
    }
    button:hover {
      background: #0056b3;
    }
    .parcel-card {
      background: white;
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .volume-container input {
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>

<h1>Мобільна база посилок</h1>

<form id="parcelForm">
  <label for="number">№ Посилки</label>
  <input type="text" id="number" required />

  <label for="weight">Вага (кг)</label>
  <input type="number" id="weight" step="0.01" min="0" required />

  <label for="places">Кількість місць</label>
  <input type="number" id="places" step="1" min="1" required />

  <div id="volumeFields" class="volume-container"></div>

  <label for="city">Місто</label>
  <input type="text" id="city" required />

  <label for="branch">Відділення НП</label>
  <input type="text" id="branch" required />

  <label for="phone">Телефон</label>
  <input type="tel" id="phone" required pattern="^\+?\d{7,15}$" placeholder="+380..." />

  <label for="price">Ціна (€)</label>
  <input type="number" id="price" step="0.01" min="0" required />

  <label for="desc">Опис</label>
  <textarea id="desc" rows="2"></textarea>

  <button type="submit">Додати посилку</button>
</form>

<div id="parcelList"></div>

<script>
  const parcelForm = document.getElementById('parcelForm');
  const parcelList = document.getElementById('parcelList');
  const volumeFields = document.getElementById('volumeFields');
  const placesInput = document.getElementById('places');

  let parcels = JSON.parse(localStorage.getItem('parcels') || '[]');

  // Рендер посилок
  function renderParcels() {
    parcelList.innerHTML = '';
    parcels.forEach(p => {
      const div = document.createElement('div');
      div.className = 'parcel-card';
      div.innerHTML = `
        <strong>${p.number}</strong><br/>
        Вага: ${p.weight} кг<br/>
        Кількість місць: ${p.places}<br/>
        Обʼємна вага: ${p.volume.join(', ')}<br/>
        Місто: ${p.city}<br/>
        Відділення НП: ${p.branch}<br/>
        Телефон: ${p.phone}<br/>
        Ціна: €${p.price}<br/>
        Опис: ${p.desc || '—'}
      `;
      parcelList.appendChild(div);
    });
  }

  // Динамічне створення полів для обʼємної ваги
  placesInput.addEventListener('input', () => {
    const count = parseInt(placesInput.value);
    volumeFields.innerHTML = '';
    if (count > 0) {
      for (let i = 0; i < count; i++) {
        const input = document.createElement('input');
        input.type = 'number';
        input.step = '0.01';
        input.min = '0';
        input.placeholder = `Обʼємна вага для місця #${i + 1}`;
        input.required = true;
        volumeFields.appendChild(input);
      }
    }
  });

  // Обробка форми
  parcelForm.addEventListener('submit', e => {
    e.preventDefault();
    const volumeInputs = volumeFields.querySelectorAll('input');
    const volume = Array.from(volumeInputs).map(i => parseFloat(i.value));
    const data = {
      number: document.getElementById('number').value,
      weight: parseFloat(document.getElementById('weight').value),
      places: parseInt(document.getElementById('places').value),
      volume,
      city: document.getElementById('city').value,
      branch: document.getElementById('branch').value,
      phone: document.getElementById('phone').value,
      price: parseFloat(document.getElementById('price').value),
      desc: document.getElementById('desc').value
    };
    parcels.push(data);
    localStorage.setItem('parcels', JSON.stringify(parcels));
    renderParcels();
    parcelForm.reset();
    volumeFields.innerHTML = '';
  });

  renderParcels();
</script>

</body>
</html>